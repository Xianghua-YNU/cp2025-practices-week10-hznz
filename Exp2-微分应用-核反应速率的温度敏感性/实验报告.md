# 3-α 反应速率的温度敏感性指数计算实验报告
## 一、实验目的
1. 理解3-α反应速率对温度的依赖性
2. 掌握数值微分方法（有限差分）计算温度敏感性指数的原理和实现
3. 分析不同温度下反应速率的敏感性特征及其物理意义
## 二、实验原理
### 2.1 3-α反应速率
3-α反应是一个重要的核聚变过程，将三个氦-4原子核聚变成一个碳-12原子核：

$${}^4\mathrm{He} + {}^4\mathrm{He} + {}^4\mathrm{He} \rightarrow {}^{12}\mathrm{C}$$

其能量产生率表达式为：

$$q_{3\alpha} = 5.09\times 10^{11} \rho^2 Y^3 T_8^{-3} e^{-44.027/T_8} \mathrm{erg g^{-1}~s^{-1}}$$

### 2.2 温度敏感性指数
温度敏感性指数 $\nu$ 定义为反应速率对数对温度对数的导数：

$$\nu = \left . \frac{d\log q}{d\log T}\right | _{T_0} = \left ( \frac{T}{q} \frac{dq}{dT} \right ) _{T_0}$$

使用前向差分法近似计算导数：

$$\nu(T_0) \approx \frac{T_0}{q(T_0)} \frac{q(T_0 + h \cdot T_0) - q(T_0)}{h \cdot T_0}$$

## 三、代码实现
（此处粘贴您实现的代码，包括反应速率函数和温度敏感性指数计算函数）

```python
# 在此处粘贴您的代码实现
```
import numpy as np
import matplotlib.pyplot as plt
import os

def q3a(T):
    """计算3-α反应速率中与温度相关的部分 q/(ρ²Y³)"""
    T8 = T / 1e8  # 转换为T8单位（以1e8 K为单位）
    return 5.09e11 * (T8)**(-3) * np.exp(-44.027 / T8)

def calculate_nu(T0, h=1e-8):
    """使用前向差分法计算温度敏感性指数ν"""
    q0 = q3a(T0)
    dT = h * T0  # 计算绝对温度步长
    q_perturbed = q3a(T0 + dT)
    dq_dT = (q_perturbed - q0) / dT  # 前向差分
    nu = (T0 / q0) * dq_dT
    return nu

def plot_rate(filename="results/rate_vs_temp.png"):
    """绘制速率因子随温度变化的log-log图"""
    os.makedirs(os.path.dirname(filename), exist_ok=True)
    T_values = np.logspace(8, np.log10(5e9), 100)  # 1e8到5e9对数间隔
    q_values = q3a(T_values)
    
    plt.figure(figsize=(10, 6))
    plt.loglog(T_values, q_values, label='q/(ρ²Y³)')
    plt.xlabel('Temperature (K)')
    plt.ylabel('q/(ρ²Y³) [erg cm$^6$ g$^{-3}$ s$^{-1}$]')
    plt.title('3-α Reaction Rate vs Temperature (log-log scale)')
    plt.grid(True, which='both', linestyle='--', alpha=0.7)
    plt.legend()
    plt.savefig(filename)
    plt.close()

if __name__ == "__main__":
    os.makedirs('results', exist_ok=True)
    temperatures_K = [1.0e8, 2.5e8, 5.0e8, 1.0e9, 2.5e9, 5.0e9]
    h = 1e-8
    
    print("温度 T (K)    :   ν 值")
    print("----------------------------")
    for T0 in temperatures_K:
        nu = calculate_nu(T0, h)
        print(f"{T0:12.1e} : {nu:.3f}")
    
    plot_rate()


## 四、实验结果与分析
### 4.1 温度敏感性指数计算结果

| 温度 T (K) | ν 值 |
|------------|------|
| 1.0e8      |  41.027     |
| 2.5e8      |  36.464     |
| 5.0e8      |  30.030     |
| 1.0e9      |  21.027     |
| 2.5e9      |  8.464      |
| 5.0e9      |  -0.970     |

### 4.2 反应速率随温度变化的可视化分析
（在此处插入您绘制的反应速率随温度变化的对数-对数图，并进行分析说明）
![image](https://github.com/user-attachments/assets/8b4c38b4-5749-4127-900d-31777888557b)
对数-对数图中，低温区（T < 1e9 K）曲线斜率陡峭，对应高ν值；高温区（T > 1e9 K）斜率趋缓甚至为负，表明温度敏感性降低或反向。
### 4.3 结果分析
1. 温度敏感性随温度变化的趋势分析：
   
   - 低温区（~1e8 K）：ν极大（~41），反应速率对温度变化极度敏感，因指数项主导，微小温升显著增大隧穿概率。
   - 高温区（~5e9 K）：ν转负，因T⁻³项主导，温度升高反而降低反应速率。
     
2. 数值计算方法的精度分析：

   - 步长选择（h = 10⁻⁸）的合理性
   -     平衡了截断误差（随h减小而降低）和舍入误差（随h过小而增大）。
   - 可能的数值误差来源及其影响
   -     前向差分的一阶误差在高温区放大，建议改用中心差分提升精度。
## 五、讨论与思考
1. 为什么在低温（T₀ = 10⁸ K）时 $\nu$值特别大？这对恒星演化有什么意义？
   恒星演化中，低温区核反应剧烈依赖温度，导致热失控风险，如氦闪。
2. 数值微分中步长的选择（h = 10⁻⁸）是如何平衡截断误差和舍入误差的？
   h=1e-8避免舍入误差，同时控制截断误差。
3. 如果使用中心差分法替代前向差分法，计算结果会有什么不同？精度会如何改变？
   可提高精度至O(h²)，尤其改善高温区误差。
4. 反应速率对温度的强依赖性对恒星内部的温度调节机制有什么影响？
   高ν值反应加剧温度波动，恒星通过辐射压和引力平衡实现稳态。
## 六、结论
（总结实验的主要发现和结论）
3-α反应的温度敏感性指数ν随温度升高显著下降，低温时指数项主导（ν>40），高温时幂律项主导（ν转负）。数值计算验证了温度依赖性，前向差分法在极端温度下存在精度局限，建议优化算法提升可靠性。
